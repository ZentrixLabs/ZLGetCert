<Window x:Class="ZLGetCert.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:enums="clr-namespace:ZLGetCert.Enums"
        xmlns:local="clr-namespace:ZLGetCert.Converters"
        mc:Ignorable="d"
        Title="ZLGetCert - Certificate Management" 
        Height="800" 
        Width="1000"
        MinHeight="600"
        MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Icon="pack://application:,,,/ZLGetCert_icon_v2.ico">
    
    <Window.Resources>
        <!-- Converters -->
        <local:EnumToBoolConverter x:Key="EnumToBoolConverter"/>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <local:InverseBoolConverter x:Key="InverseBoolConverter"/>
        
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="SectionTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,15,0,5"/>
        </Style>
        
        <Style x:Key="StatusTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="#F8F9FA" BorderBrush="#E9ECEF" BorderThickness="0,0,0,1">
            <MenuItem Header="_File">
                <MenuItem Header="_New Certificate" 
                          Command="{Binding ClearFormCommand}"
                          ToolTip="Clear the form and start a new certificate request (Ctrl+N)"
                          InputGestureText="Ctrl+N"/>
                <Separator/>
                <MenuItem Header="E_xit" 
                          Click="Exit_Click"
                          ToolTip="Exit the application (Alt+F4)"
                          InputGestureText="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Settings" 
                          Command="{Binding ShowSettingsCommand}"
                          ToolTip="Open application settings panel (Ctrl+,)"
                          InputGestureText="Ctrl+,"/>
                <MenuItem Header="_Configuration Editor..." 
                          Command="{Binding OpenConfigurationEditorCommand}"
                          ToolTip="Edit appsettings.json directly with JSON validation"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Users Guide" 
                          Command="{Binding OpenUsersGuideCommand}"
                          ToolTip="Open comprehensive users guide (F1)"
                          InputGestureText="F1"/>
                <MenuItem Header="_About" 
                          Click="About_Click"
                          ToolTip="About ZLGetCert - Version and credits"/>
            </MenuItem>
        </Menu>

        <!-- Header -->
        <Border Grid.Row="1" Background="#2E3440" Padding="20,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="ZLGetCert" Style="{StaticResource HeaderTextStyle}" Foreground="White"/>
                    <TextBlock Text="Certificate Management for On-Premises CA" 
                               Style="{StaticResource StatusTextStyle}" Foreground="#D8DEE9"/>
                </StackPanel>
                
                <!-- Quick Actions -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- Settings moved to Edit menu - no header button needed -->
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <!-- Certificate Request Form -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                <StackPanel>
                    <Grid>
                        <TextBlock Text="Certificate Request" 
                                   Style="{StaticResource HeaderTextStyle}"
                                   HorizontalAlignment="Left"/>
                        <TextBlock HorizontalAlignment="Right" 
                                   VerticalAlignment="Center"
                                   Margin="0,0,0,10">
                            <Hyperlink Command="{Binding OpenUsersGuideCommand}" 
                                       TextDecorations="None">
                                <Run Text="â“ Click Here for Help" 
                                     FontSize="14" 
                                     Foreground="#007ACC"/>
                            </Hyperlink>
                        </TextBlock>
                    </Grid>
                    
                    <!-- Certificate Authority Configuration Card -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Certificate Authority" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="CA Server *" Style="{StaticResource FieldLabelStyle}"/>
                                <ComboBox ItemsSource="{Binding CertificateRequest.AvailableCAs}" 
                                          Text="{Binding CertificateRequest.CAServer}"
                                          IsEditable="True"
                                          ToolTip="Required: Select your organization's Certificate Authority server from Active Directory or type a custom CA server name. Example: ca.company.com">
                                    <ComboBox.Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Foreground" Value="Black"/>
                                        </Style>
                                    </ComboBox.Style>
                                </ComboBox>
                                <TextBlock Text="Select from Active Directory CAs or type a custom server name" 
                                           Style="{StaticResource StatusTextStyle}"
                                           Margin="0,2,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="Certificate Template *" Style="{StaticResource FieldLabelStyle}"/>
                                <ComboBox ItemsSource="{Binding CertificateRequest.AvailableTemplates}" 
                                          SelectedValue="{Binding CertificateRequest.Template}"
                                          SelectedValuePath="Name"
                                          DisplayMemberPath="DisplayText"
                                          IsEditable="True"
                                          ToolTip="Required: Select the certificate template (determines certificate type and usage). Examples: WebServer for SSL/TLS, CodeSigning for software signing, User for VPN/authentication">
                                    <ComboBox.Style>
                                        <Style TargetType="ComboBox">
                                            <Setter Property="Foreground" Value="Black"/>
                                        </Style>
                                    </ComboBox.Style>
                                </ComboBox>
                                <TextBlock Text="Select from the list or type a custom template name" 
                                           Style="{StaticResource StatusTextStyle}"
                                           Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Wildcard Option Card (Only for Web Server templates) -->
                    <Border Style="{StaticResource CardStyle}"
                            Visibility="{Binding CertificateRequest.ShowWildcardOption, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Certificate Options" Style="{StaticResource SectionHeaderStyle}"/>
                            <CheckBox Content="Wildcard Certificate (*.domain.com)"
                                      IsChecked="{Binding CertificateRequest.IsWildcard}"
                                      ToolTip="Generate a wildcard certificate valid for all subdomains. Example: *.company.com secures www.company.com, api.company.com, mail.company.com, etc."
                                      Margin="0,5,0,10"/>
                            <TextBlock Text="A wildcard certificate can secure *.company.com (all subdomains)" 
                                       Style="{StaticResource StatusTextStyle}"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <!-- CSR Import Option (shown when CSR file is selected) -->
                    <Border Style="{StaticResource CardStyle}" 
                            Visibility="{Binding CertificateRequest.IsCSRWorkflow, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="CSR File Import" Style="{StaticResource SectionHeaderStyle}"/>
                            <TextBlock Text="âœ… CSR file loaded - hostname, organization info, and SANs from CSR" 
                                       Foreground="Green"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" 
                                         Text="{Binding CertificateRequest.CsrFilePath}" 
                                         IsReadOnly="True"
                                         Margin="0,0,10,0"/>
                                <Button Grid.Column="1" 
                                        Content="âŒ Clear" 
                                        Click="ClearCSR_Click"
                                        Style="{StaticResource SecondaryButtonStyle}"/>
                            </Grid>
                            <TextBlock Text="â„¹ï¸ The CSR file already contains subject DN and SANs. You only need to select the CA server, template, and password." 
                                       Style="{StaticResource StatusTextStyle}"
                                       TextWrapping="Wrap"
                                       Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Hostname and FQDN Card (Only for Web Server templates) -->
                    <Border Style="{StaticResource CardStyle}" 
                            Visibility="{Binding CertificateRequest.ShowHostnameFields, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Domain Information" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="Hostname *" Style="{StaticResource FieldLabelStyle}"/>
                                <TextBox Text="{Binding CertificateRequest.HostName}" 
                                         IsEnabled="{Binding CertificateRequest.IsWildcard, Converter={StaticResource InverseBoolConverter}}"
                                         ToolTip="Required for standard certificates: Server hostname without domain. Examples: www, api, mail, vpn"/>
                                <TextBlock Text="Not needed for wildcard certificates" 
                                           Visibility="{Binding CertificateRequest.IsWildcard, Converter={StaticResource BoolToVisibilityConverter}}"
                                           Style="{StaticResource StatusTextStyle}"
                                           Margin="0,2,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="Fully Qualified Domain Name (FQDN)" Style="{StaticResource FieldLabelStyle}"/>
                                <TextBox Text="{Binding CertificateRequest.FQDN}" 
                                         IsReadOnly="True"
                                         Background="#F5F5F5"
                                         ToolTip="Auto-generated from hostname + organization. Example: api.company.com = hostname (api) + organization (company.com)"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Organization Information Card (Not needed for CSR import - already in CSR) -->
                    <Border Style="{StaticResource CardStyle}"
                            Visibility="{Binding CertificateRequest.IsCSRWorkflow, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Organization Information" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Style="{StaticResource FormGroupStyle}">
                                    <TextBlock Text="Location (City) *" Style="{StaticResource FieldLabelStyle}"/>
                                    <TextBox Text="{Binding CertificateRequest.Location}"
                                             ToolTip="Required: City name for certificate subject. Examples: Seattle, New York, London"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" Style="{StaticResource FormGroupStyle}">
                                    <TextBlock Text="State *" Style="{StaticResource FieldLabelStyle}"/>
                                    <TextBox Text="{Binding CertificateRequest.State}" 
                                             MaxLength="2"
                                             ToolTip="Required: Two-letter state/province code. Examples: WA, CA, NY, TX"/>
                                </StackPanel>
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Style="{StaticResource FormGroupStyle}">
                                    <TextBlock Text="Organization *" Style="{StaticResource FieldLabelStyle}"/>
                                    <TextBox Text="{Binding CertificateRequest.Company}"
                                             ToolTip="Required: Your organization's domain name. Examples: company.com, organization.org"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" Style="{StaticResource FormGroupStyle}">
                                    <TextBlock Text="Organizational Unit *" Style="{StaticResource FieldLabelStyle}"/>
                                    <TextBox Text="{Binding CertificateRequest.OU}"
                                             ToolTip="Required: Department or division name. Examples: IT, Engineering, Operations"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- SANs Card (Only for Web Server templates) -->
                    <Border Style="{StaticResource CardStyle}" 
                            Visibility="{Binding CertificateRequest.ShowHostnameFields, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Subject Alternative Names (SANs)" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <!-- DNS SANs -->
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="DNS Names" Style="{StaticResource FieldLabelStyle}"/>
                                <ItemsControl ItemsSource="{Binding CertificateRequest.DnsSans}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="0,2">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Grid.Column="0" 
                                                         Text="{Binding Value}" 
                                                         Margin="0,0,10,0"/>
                                                <Button Grid.Column="1" 
                                                        Content="âŒ" 
                                                        Command="{Binding DataContext.RemoveDnsSanCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource IconButtonStyle}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                <Button Content="âž• Add DNS Name" 
                                        Command="{Binding AddDnsSanCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Margin="0,5,0,0"/>
                            </StackPanel>

                            <!-- IP SANs -->
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="IP Addresses" Style="{StaticResource FieldLabelStyle}"/>
                                <ItemsControl ItemsSource="{Binding CertificateRequest.IpSans}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="0,2">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Grid.Column="0" 
                                                         Text="{Binding Value}" 
                                                         Margin="0,0,10,0"/>
                                                <Button Grid.Column="1" 
                                                        Content="âŒ" 
                                                        Command="{Binding DataContext.RemoveIpSanCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource IconButtonStyle}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                <Button Content="âž• Add IP Address" 
                                        Command="{Binding AddIpSanCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Margin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Security Settings Card -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Security Settings" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <!-- PFX Password -->
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="PFX Password *" Style="{StaticResource FieldLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" 
                                             Text="{Binding CertificateRequest.PfxPassword}"
                                             Margin="0,0,10,0"
                                             ToolTip="Required: Strong password to protect the PFX certificate file. Minimum 8 characters with uppercase, lowercase, and numbers."/>
                                    <Button Grid.Column="1" 
                                            Content="ðŸ‘" 
                                            Command="{Binding CertificateRequest.TogglePasswordVisibilityCommand}"
                                            Style="{StaticResource IconButtonStyle}"
                                            ToolTip="Toggle password visibility"/>
                                </Grid>
                                <TextBlock Text="{Binding CertificateRequest.PasswordStrength}" 
                                           Style="{StaticResource StatusTextStyle}"/>
                            </StackPanel>

                            <!-- Confirm Password -->
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <TextBlock Text="Confirm Password *" Style="{StaticResource FieldLabelStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" 
                                             Text="{Binding CertificateRequest.ConfirmPassword}"
                                             Margin="0,0,10,0"
                                             ToolTip="Required: Re-enter your password to confirm it matches"/>
                                    <Button Grid.Column="1" 
                                            Content="ðŸ‘" 
                                            Command="{Binding CertificateRequest.ToggleConfirmPasswordVisibilityCommand}"
                                            Style="{StaticResource IconButtonStyle}"
                                            ToolTip="Toggle password visibility"/>
                                </Grid>
                            </StackPanel>

                            <!-- PEM/KEY Export Options -->
                            <StackPanel Style="{StaticResource FormGroupStyle}">
                                <CheckBox Content="Extract PEM and KEY files" 
                                          IsChecked="{Binding CertificateRequest.ExtractPemKey}"
                                          ToolTip="Export certificate and private key in PEM format. Required for Apache, NGINX, HAProxy and other web servers. Built-in .NET export - no OpenSSL needed."/>
                                
                                <!-- Security Warning for Unencrypted Keys -->
                                <Border Background="#FFF3CD" 
                                        BorderBrush="#FFC107" 
                                        BorderThickness="1" 
                                        Padding="10"
                                        Margin="0,10,0,10"
                                        Visibility="{Binding CertificateRequest.ShowKeySecurityWarning, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="âš ï¸ SECURITY NOTICE" 
                                                   FontWeight="Bold" 
                                                   Foreground="#856404"
                                                   Margin="0,0,0,5"/>
                                        <TextBlock TextWrapping="Wrap" Foreground="#856404" FontSize="11">
                                            <Run Text="The .key file will be UNENCRYPTED (required by web servers)."/>
                                            <LineBreak/>
                                            <LineBreak/>
                                            <Run Text="Security protections applied:"/>
                                            <LineBreak/>
                                            <Run Text="âœ“ File permissions set to owner-only automatically"/>
                                            <LineBreak/>
                                            <Run Text="âœ“ All exports logged to audit trail"/>
                                            <LineBreak/>
                                            <LineBreak/>
                                            <Run Text="Your responsibilities:"/>
                                            <LineBreak/>
                                            <Run Text="â€¢ Copy to server using encrypted transfer (SFTP/SCP)"/>
                                            <LineBreak/>
                                            <Run Text="â€¢ Verify file permissions on destination (chmod 600)"/>
                                            <LineBreak/>
                                            <Run Text="â€¢ Securely delete local copy after deployment"/>
                                            <LineBreak/>
                                            <Run Text="â€¢ NEVER store in cloud storage or version control"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                                
                                <CheckBox Content="Extract CA bundle (intermediate + root certificates)" 
                                          IsChecked="{Binding CertificateRequest.ExtractCaBundle}"
                                          IsEnabled="{Binding CertificateRequest.ExtractPemKey}"
                                          Margin="0,5,0,0"
                                          ToolTip="Export the certificate chain (intermediate and root CA certificates) for full server validation. Recommended for web servers."/>
                                <TextBlock Text="{Binding OpenSSLStatus}" 
                                           Style="{StaticResource StatusTextStyle}"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Action Buttons Card -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Actions" Style="{StaticResource SectionHeaderStyle}"/>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="ðŸ”§ Generate Certificate" 
                                        Command="{Binding GenerateCertificateCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Margin="0,0,10,0"
                                        ToolTip="Generate the certificate with the settings above (Alt+G)"
                                        FontSize="14"
                                        Padding="20,10"
                                        FontWeight="SemiBold"/>
                                <Button Content="ðŸ“„ Import from CSR File..." 
                                        Command="{Binding CertificateRequest.ImportFromCSRCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        ToolTip="Submit an existing Certificate Signing Request file to the CA (Alt+I)"
                                        Margin="0,0,10,0"/>
                                <Button Content="ðŸ’¾ Save as Defaults" 
                                        Command="{Binding SaveAsDefaultsCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        ToolTip="Save current CA server, template, and organization settings as defaults (Alt+D)"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Settings panel removed - now opens in dedicated window -->

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="#F8F9FA" BorderBrush="#E9ECEF" BorderThickness="0,1,0,0" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ“‹ " FontSize="16" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding StatusMessage}" 
                               VerticalAlignment="Center"
                               FontSize="13"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="ðŸ” Generate Certificate" 
                            Command="{Binding GenerateCertificateCommand}"
                            Style="{StaticResource PrimaryButtonStyle}"
                            IsEnabled="{Binding CertificateRequest.CanGenerate}"
                            Padding="20,10"
                            FontSize="14"
                            FontWeight="SemiBold"
                            ToolTip="Generate the certificate with the settings above (Alt+G)"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
